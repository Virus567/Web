using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net.Mail;
using RestPanda.Requests.Attributes;
using RestPanda.Requests;
using WebServer.Entity;
using System.Net;

namespace WebServer.Requests
{
    [RequestHandler]
    public class HandlerEmail
    {
        private static string FillTable()
        {
            var s = new StringBuilder("<table style=\"border-collapse: collapse\">" + Environment.NewLine);
            s.Append("<tr><th>id</th><th>ФИО</th><th>Возраст</th><th>Почта</th></tr>" + Environment.NewLine);
            foreach (var student in Student.Students)
            {
                s.Append("<tr>").Append($"<td>{student.id}</td>").Append($"<td>{student.fio}</td>")
                    .Append($"<td>{student.age}</td>").Append($"<td>{student.email}</td>").Append("</tr>" + Environment.NewLine);
            }

            s.Append("</table>");
            return s.ToString();
        }

        [Get]
        public static void CommitMessange(PandaRequest request, PandaResponse response)
        {
            var from = new MailAddress("tourist-center-vyatsu@mail.ru", "Администрация туристического центра");
            var to = new MailAddress("i.b.a1@mail.ru", "Пользователь");
            var msg = new MailMessage(from, to);
            msg.Subject = "PDF file";
            msg.Attachments.Add(
                new Attachment("C://Users/admin/Desktop/тест.pdf"));
            msg.Body = "Тестовое сообщение";
            using (var smtp = new SmtpClient("smtp.mail.ru", 587))
            {
                smtp.Credentials = new NetworkCredential("tourist-center-vyatsu@mail.ru", "KHJGuMh1AMswAADBP9CL");
                smtp.EnableSsl = true;
                smtp.Send(msg);
            }

            var msg2 = new MailMessage(from, to);
            msg2.Subject = "Html документ";
            msg2.Body = "<img src=\"data:image/jpeg;base64,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\" alt=\"Алеша\"/>" + Environment.NewLine;
            msg2.Body += FillTable();
            msg2.IsBodyHtml = true;
            using (var smtp = new SmtpClient("smtp.mail.ru", 587))
            {
                smtp.Credentials = new NetworkCredential("tourist-center-vyatsu@mail.ru", "KHJGuMh1AMswAADBP9CL");
                smtp.EnableSsl = true;
                smtp.Send(msg2);
            }

            response.Send("");
        }
    }
}
